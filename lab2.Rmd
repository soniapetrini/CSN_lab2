---
title: "CSN_lab2"
output: html_notebook
---

# Analysis of nodes degree distribution 

After finding the parameters and the best model, plot the data and a theoretical curve to see if there is sufficient agreement 

("I give x and y, use a double log scale for viz")

```{r}
#install.packages("stats4,VGAN")

library(ggplot2)
require("stats4") # for MLE
require("VGAM")

```


Degree sequence of the English network

```{r}
#degree_sequence = read.table("./data/English_degree_sequence.txt",
                  header = FALSE)
nrow(degree_sequence)   # number of nodes 
```
```{r}
sum(degree_sequence)    # sum of total degrees
sum(degree_sequence)/dim(degree_sequence)[1]    # mean degree
spectrum <- table(degree_sequence)
```


```{r}
barplot(spectrum, main = "English",
        xlab = "degree", ylab = "number of vertices")
```

```{r}
barplot(spectrum, main = "English",
        xlab = "degree", ylab = "number of vertices", log = "xy")
```



```{r}
source("summary_table.R")

```

```{r}
write_summary <- function(language,file) {
   degree_sequence = read.table(file, header = FALSE)
    return(c(language,length(degree_sequence$V1),max(degree_sequence$V1),sum(degree_sequence$V1)/length(degree_sequence$V1),length(degree_sequence$V1)/sum(degree_sequence$V1)))
}
```



# IN-DEGREE DISTRIBUTION

Table 1: Summary of the properties of the degree sequences. N is the number of nodes, M/N is mean degree where M is the sum of degrees.

```{r}
write_summary(source$language[1], source$file[1])
```


```{r}
source = read.table("list_in.txt", header = TRUE, 
         as.is = c("language","file"))

lang_tab = data.frame()
for (x in 1:nrow(source)) {
    out <- print(write_summary(source$language[x], source$file[x]))
    lang_tab = rbind(df, out)
}

```

```{r}
x <- 1:2
y <- 1:10
n <- max(length(x), length(y))
length(x) <- n                      
length(y) <- n

#lang_tab = data.frame()
#for (x in 1:nrow(source)) {
#    degree_sequence = read.table(source$file[x])
#    lang_tab = cbind(lang_tab, degree_sequence)
#}

en_degree_sequence = read.table("./data/English_in-degree_sequence.txt", header = FALSE)
degree_sequence = read.table("./data/English_degree_sequence.txt", header = FALSE)
degree_sequence = read.table("./data/English_degree_sequence.txt", header = FALSE)
degree_sequence = read.table("./data/English_degree_sequence.txt", header = FALSE)
degree_sequence = read.table("./data/English_degree_sequence.txt", header = FALSE)

```



```{r}
x <- en_degree_sequence$V1
M <- sum(x)
N <- length(x)
M_1 <- sum(log(x))



## zeta
minus_log_like_zeta <- function(gamma) {
     N * log(zeta(gamma)) + gamma * M_1
}

mle_zeta <- mle(minus_log_like_zeta,
            start = list(gamma = 2),
            method = "L-BFGS-B",
            lower = c(1.0000001))


## Poisson
minus_log_like_poisson <- function(gamma) {
     M * log(gamma) - N*(gamma + log(1-(e^-1))) - 
}

mle_poisson <- mle(minus_log_like_poisson,
            start = list(gamma = 2),
            method = "L-BFGS-B",
            lower = c(1.0000001))




```




